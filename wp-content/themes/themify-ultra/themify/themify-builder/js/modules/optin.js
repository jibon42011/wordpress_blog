(($,t,c,e)=>{"use strict";const a=a=>{const o=t.createElement("div",{class:"tf_loader tf_abs_c"}),s=a.tfClass("themify_captcha_field")[0];if(s)if(s.classList.contains("h-captcha"))c.hcaptcha===e&&t.loadJs("https://js.hcaptcha.com/1/api.js?recaptchacompat=off",null,!1);else if(c.grecaptcha===e){let c="https://www.google.com/recaptcha/api.js";"v3"===s.dataset.ver&&(c+="?render="+s.dataset.sitekey),t.loadJs(c,null,!1)}(a=>{t.is_builder_active||a.tfOn("submit",(async s=>{s.preventDefault();const n=s.currentTarget,i=n.parentElement;if(!n.classList.contains("processing")){i.appendChild(o),i.tfClass("tb_optin_error_message")[0].style.display="none",n.className+=" processing";const r=a.tfClass("themify_captcha_field")[0];try{if("v3"===r?.dataset.ver&&c.grecaptcha!==e){const t=await new Promise(((t,e)=>{c.grecaptcha.ready((()=>{c.grecaptcha.execute(r.dataset.sitekey,{action:"captcha"}).then(t).catch(e)}))})),e=document.createElement("input");e.type="hidden",e.name="g-recaptcha-response",e.value=t,n.prepend(e)}await(async e=>{const a=new FormData(e),s=e.querySelector('[name="g-recaptcha-response"]');null!==s&&a.set("contact-recaptcha",s.value);const n=await t.fetch(a);if(o.remove(),!n.success)throw e.parentElement.tfClass("tb_optin_error_message")[0].style.display="block",n.data.error;"s1"===e.dataset.success?c.location.href=n.data.redirect:$(e).fadeOut().closest(".module").find(".tb_optin_success_message").fadeIn()})(n)}catch(s){console.error(s)}n.classList.remove("processing"),"v2"===r?.dataset.ver&&c.grecaptcha?.reset()}}))})(a)};t.on("builder_load_module_partial",((c,e)=>{if(!0===e&&!c.classList.contains("module-optin"))return;const o=t.selectWithParent("tb_optin_form",c)[0];o&&t.requestIdleCallback((()=>{a(o)}),300)}))})(jQuery,Themify,window,void 0);